{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { TruckIcon, MapPinIcon, ClockIcon } from '@heroicons/vue/24/outline';\nimport { useAuthStore } from '../../stores/auth';\nimport api from '../../services/api';\nimport { useToast } from 'vue-toastification';\nimport { format } from 'date-fns';\nimport { es } from 'date-fns/locale';\nexport default {\n  __name: 'Dashboard',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const authStore = useAuthStore();\n    const toast = useToast();\n    const userStats = ref({});\n    const vehiculos = ref([]);\n    const recentActivity = ref([]);\n    const showDetailsModal = ref(false);\n    const selectedVehicle = ref(null);\n    const fetchUserData = async () => {\n      try {\n        const [statsRes, vehiculosRes, activityRes] = await Promise.all([api.get('/user/stats'), api.get('/user/vehiculos'), api.get('/user/activity')]);\n        userStats.value = statsRes.data.data;\n        vehiculos.value = vehiculosRes.data.data;\n        recentActivity.value = activityRes.data.data;\n      } catch (error) {\n        toast.error('Error al cargar los datos');\n      }\n    };\n    const viewVehicleDetails = vehiculo => {\n      selectedVehicle.value = vehiculo;\n      showDetailsModal.value = true;\n    };\n    const formatDate = date => {\n      return format(new Date(date), 'dd/MM/yyyy HH:mm', {\n        locale: es\n      });\n    };\n    onMounted(() => {\n      fetchUserData();\n    });\n    const __returned__ = {\n      authStore,\n      toast,\n      userStats,\n      vehiculos,\n      recentActivity,\n      showDetailsModal,\n      selectedVehicle,\n      fetchUserData,\n      viewVehicleDetails,\n      formatDate,\n      ref,\n      onMounted,\n      get TruckIcon() {\n        return TruckIcon;\n      },\n      get MapPinIcon() {\n        return MapPinIcon;\n      },\n      get ClockIcon() {\n        return ClockIcon;\n      },\n      get useAuthStore() {\n        return useAuthStore;\n      },\n      get api() {\n        return api;\n      },\n      get useToast() {\n        return useToast;\n      },\n      get format() {\n        return format;\n      },\n      get es() {\n        return es;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","TruckIcon","MapPinIcon","ClockIcon","useAuthStore","api","useToast","format","es","authStore","toast","userStats","vehiculos","recentActivity","showDetailsModal","selectedVehicle","fetchUserData","statsRes","vehiculosRes","activityRes","Promise","all","get","value","data","error","viewVehicleDetails","vehiculo","formatDate","date","Date","locale"],"sources":["C:/Users/MG/Documents/Proyecto/Proyecto 2/frontend/src/views/user/Dashboard.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <!-- Header -->\n    <div class=\"md:flex md:items-center md:justify-between\">\n      <div class=\"min-w-0 flex-1\">\n        <h2 class=\"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight\">\n          Mi Dashboard\n        </h2>\n        <p class=\"mt-1 text-sm text-gray-500\">\n          Bienvenido, {{ authStore.user?.nombre }} {{ authStore.user?.apellido }}\n        </p>\n      </div>\n    </div>\n\n    <!-- Stats -->\n    <div class=\"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3\">\n      <div class=\"bg-white overflow-hidden shadow rounded-lg\">\n        <div class=\"p-5\">\n          <div class=\"flex items-center\">\n            <div class=\"flex-shrink-0\">\n              <TruckIcon class=\"h-6 w-6 text-gray-400\" />\n            </div>\n            <div class=\"ml-5 w-0 flex-1\">\n              <dl>\n                <dt class=\"text-sm font-medium text-gray-500 truncate\">Mis Vehículos</dt>\n                <dd class=\"text-lg font-medium text-gray-900\">{{ userStats.vehiculos_asignados || 0 }}</dd>\n              </dl>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white overflow-hidden shadow rounded-lg\">\n        <div class=\"p-5\">\n          <div class=\"flex items-center\">\n            <div class=\"flex-shrink-0\">\n              <MapPinIcon class=\"h-6 w-6 text-green-400\" />\n            </div>\n            <div class=\"ml-5 w-0 flex-1\">\n              <dl>\n                <dt class=\"text-sm font-medium text-gray-500 truncate\">Ubicaciones Activas</dt>\n                <dd class=\"text-lg font-medium text-gray-900\">{{ userStats.ubicaciones_activas || 0 }}</dd>\n              </dl>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"bg-white overflow-hidden shadow rounded-lg\">\n        <div class=\"p-5\">\n          <div class=\"flex items-center\">\n            <div class=\"flex-shrink-0\">\n              <ClockIcon class=\"h-6 w-6 text-blue-400\" />\n            </div>\n            <div class=\"ml-5 w-0 flex-1\">\n              <dl>\n                <dt class=\"text-sm font-medium text-gray-500 truncate\">Última Actualización</dt>\n                <dd class=\"text-sm font-medium text-gray-900\">\n                  {{ userStats.ultima_actualizacion ? formatDate(userStats.ultima_actualizacion) : 'Sin datos' }}\n                </dd>\n              </dl>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- My Vehicles -->\n    <div class=\"bg-white shadow rounded-lg\">\n      <div class=\"px-4 py-5 sm:p-6\">\n        <h3 class=\"text-lg font-medium text-gray-900 mb-4\">Mis Vehículos Asignados</h3>\n        \n        <div v-if=\"vehiculos.length === 0\" class=\"text-center py-8\">\n          <TruckIcon class=\"mx-auto h-12 w-12 text-gray-400\" />\n          <h3 class=\"mt-2 text-sm font-medium text-gray-900\">No tienes vehículos asignados</h3>\n          <p class=\"mt-1 text-sm text-gray-500\">\n            Contacta al administrador para que te asigne un vehículo.\n          </p>\n        </div>\n\n        <div v-else class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          <div\n            v-for=\"vehiculo in vehiculos\"\n            :key=\"vehiculo.id\"\n            class=\"border rounded-lg overflow-hidden hover:shadow-md transition-shadow duration-200\"\n          >\n            <div class=\"aspect-w-16 aspect-h-9\">\n              <img\n                :src=\"vehiculo.imagenes?.[0] || '/placeholder.svg?height=200&width=300'\"\n                :alt=\"vehiculo.modelo\"\n                class=\"w-full h-32 object-cover\"\n              />\n            </div>\n            <div class=\"p-4\">\n              <div class=\"flex items-center justify-between mb-2\">\n                <h4 class=\"text-lg font-semibold text-gray-900\">{{ vehiculo.matricula }}</h4>\n                <span class=\"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-green-100 text-green-800\">\n                  Asignado\n                </span>\n              </div>\n              <p class=\"text-sm text-gray-600 mb-1\">{{ vehiculo.marca }} {{ vehiculo.modelo }}</p>\n              <p class=\"text-sm text-gray-600 mb-2\">Año: {{ vehiculo.año }}</p>\n              \n              <div v-if=\"vehiculo.ultima_ubicacion\" class=\"mb-3 p-2 bg-blue-50 rounded\">\n                <p class=\"text-xs text-blue-700\">\n                  <strong>Última ubicación:</strong><br>\n                  Lat: {{ vehiculo.ultima_ubicacion.latitud?.toFixed(6) }}<br>\n                  Lng: {{ vehiculo.ultima_ubicacion.longitud?.toFixed(6) }}<br>\n                  <strong>Actualizado:</strong> {{ formatDate(vehiculo.ultima_ubicacion.timestamp) }}\n                </p>\n              </div>\n\n              <div class=\"flex space-x-2\">\n                <router-link\n                  :to=\"`/user/mapa?vehiculo=${vehiculo.id}`\"\n                  class=\"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm text-center hover:bg-blue-700\"\n                >\n                  Ver en Mapa\n                </router-link>\n                <button\n                  @click=\"viewVehicleDetails(vehiculo)\"\n                  class=\"flex-1 bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700\"\n                >\n                  Detalles\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Recent Activity -->\n    <div class=\"bg-white shadow rounded-lg\">\n      <div class=\"px-4 py-5 sm:p-6\">\n        <h3 class=\"text-lg font-medium text-gray-900 mb-4\">Mi Actividad Reciente</h3>\n        <div class=\"flow-root\">\n          <ul class=\"-mb-8\">\n            <li v-for=\"(activity, index) in recentActivity\" :key=\"activity.id\" class=\"relative pb-8\">\n              <div v-if=\"index !== recentActivity.length - 1\" class=\"absolute top-4 left-4 -ml-px h-full w-0.5 bg-gray-200\"></div>\n              <div class=\"relative flex space-x-3\">\n                <div>\n                  <span class=\"h-8 w-8 rounded-full bg-green-500 flex items-center justify-center ring-8 ring-white\">\n                    <MapPinIcon class=\"h-4 w-4 text-white\" />\n                  </span>\n                </div>\n                <div class=\"min-w-0 flex-1 pt-1.5 flex justify-between space-x-4\">\n                  <div>\n                    <p class=\"text-sm text-gray-500\">{{ activity.description }}</p>\n                  </div>\n                  <div class=\"text-right text-sm whitespace-nowrap text-gray-500\">\n                    {{ formatDate(activity.created_at) }}\n                  </div>\n                </div>\n              </div>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n    <!-- Vehicle Details Modal -->\n    <div v-if=\"showDetailsModal\" class=\"fixed inset-0 z-50 overflow-y-auto\">\n      <div class=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n        <div class=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"></div>\n        \n        <div class=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full\">\n          <div class=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n            <h3 class=\"text-lg font-medium text-gray-900 mb-4\">Detalles del Vehículo</h3>\n            \n            <div v-if=\"selectedVehicle\" class=\"space-y-3\">\n              <div class=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Matrícula</label>\n                  <p class=\"text-sm text-gray-900\">{{ selectedVehicle.matricula }}</p>\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Estado</label>\n                  <span class=\"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium bg-green-100 text-green-800\">\n                    {{ selectedVehicle.estado }}\n                  </span>\n                </div>\n              </div>\n              \n              <div class=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Marca</label>\n                  <p class=\"text-sm text-gray-900\">{{ selectedVehicle.marca }}</p>\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Modelo</label>\n                  <p class=\"text-sm text-gray-900\">{{ selectedVehicle.modelo }}</p>\n                </div>\n              </div>\n              \n              <div class=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Año</label>\n                  <p class=\"text-sm text-gray-900\">{{ selectedVehicle.año }}</p>\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700\">Color</label>\n                  <p class=\"text-sm text-gray-900\">{{ selectedVehicle.color || 'No especificado' }}</p>\n                </div>\n              </div>\n              \n              <div>\n                <label class=\"block text-sm font-medium text-gray-700\">Kilometraje</label>\n                <p class=\"text-sm text-gray-900\">{{ selectedVehicle.kilometraje?.toLocaleString() || 0 }} km</p>\n              </div>\n            </div>\n          </div>\n          \n          <div class=\"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6\">\n            <button\n              @click=\"showDetailsModal = false\"\n              class=\"w-full inline-flex justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:mt-0 sm:w-auto\"\n            >\n              Cerrar\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue'\nimport { TruckIcon, MapPinIcon, ClockIcon } from '@heroicons/vue/24/outline'\nimport { useAuthStore } from '../../stores/auth'\nimport api from '../../services/api'\nimport { useToast } from 'vue-toastification'\nimport { format } from 'date-fns'\nimport { es } from 'date-fns/locale'\n\nconst authStore = useAuthStore()\nconst toast = useToast()\n\nconst userStats = ref({})\nconst vehiculos = ref([])\nconst recentActivity = ref([])\nconst showDetailsModal = ref(false)\nconst selectedVehicle = ref(null)\n\nconst fetchUserData = async () => {\n  try {\n    const [statsRes, vehiculosRes, activityRes] = await Promise.all([\n      api.get('/user/stats'),\n      api.get('/user/vehiculos'),\n      api.get('/user/activity')\n    ])\n    \n    userStats.value = statsRes.data.data\n    vehiculos.value = vehiculosRes.data.data\n    recentActivity.value = activityRes.data.data\n  } catch (error) {\n    toast.error('Error al cargar los datos')\n  }\n}\n\nconst viewVehicleDetails = (vehiculo) => {\n  selectedVehicle.value = vehiculo\n  showDetailsModal.value = true\n}\n\nconst formatDate = (date) => {\n  return format(new Date(date), 'dd/MM/yyyy HH:mm', { locale: es })\n}\n\nonMounted(() => {\n  fetchUserData()\n})\n</script>\n"],"mappings":"AAoOA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAI;AACnC,SAASC,SAAS,EAAEC,UAAU,EAAEC,SAAS,QAAQ,2BAA0B;AAC3E,SAASC,YAAY,QAAQ,mBAAkB;AAC/C,OAAOC,GAAG,MAAM,oBAAmB;AACnC,SAASC,QAAQ,QAAQ,oBAAmB;AAC5C,SAASC,MAAM,QAAQ,UAAS;AAChC,SAASC,EAAE,QAAQ,iBAAgB;;;;;;;IAEnC,MAAMC,SAAS,GAAGL,YAAY,CAAC;IAC/B,MAAMM,KAAK,GAAGJ,QAAQ,CAAC;IAEvB,MAAMK,SAAS,GAAGZ,GAAG,CAAC,CAAC,CAAC;IACxB,MAAMa,SAAS,GAAGb,GAAG,CAAC,EAAE;IACxB,MAAMc,cAAc,GAAGd,GAAG,CAAC,EAAE;IAC7B,MAAMe,gBAAgB,GAAGf,GAAG,CAAC,KAAK;IAClC,MAAMgB,eAAe,GAAGhB,GAAG,CAAC,IAAI;IAEhC,MAAMiB,aAAa,GAAG,MAAAA,CAAA,KAAY;MAChC,IAAI;QACF,MAAM,CAACC,QAAQ,EAAEC,YAAY,EAAEC,WAAW,CAAC,GAAG,MAAMC,OAAO,CAACC,GAAG,CAAC,CAC9DhB,GAAG,CAACiB,GAAG,CAAC,aAAa,CAAC,EACtBjB,GAAG,CAACiB,GAAG,CAAC,iBAAiB,CAAC,EAC1BjB,GAAG,CAACiB,GAAG,CAAC,gBAAgB,EACzB;QAEDX,SAAS,CAACY,KAAK,GAAGN,QAAQ,CAACO,IAAI,CAACA,IAAG;QACnCZ,SAAS,CAACW,KAAK,GAAGL,YAAY,CAACM,IAAI,CAACA,IAAG;QACvCX,cAAc,CAACU,KAAK,GAAGJ,WAAW,CAACK,IAAI,CAACA,IAAG;MAC7C,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdf,KAAK,CAACe,KAAK,CAAC,2BAA2B;MACzC;IACF;IAEA,MAAMC,kBAAkB,GAAIC,QAAQ,IAAK;MACvCZ,eAAe,CAACQ,KAAK,GAAGI,QAAO;MAC/Bb,gBAAgB,CAACS,KAAK,GAAG,IAAG;IAC9B;IAEA,MAAMK,UAAU,GAAIC,IAAI,IAAK;MAC3B,OAAOtB,MAAM,CAAC,IAAIuB,IAAI,CAACD,IAAI,CAAC,EAAE,kBAAkB,EAAE;QAAEE,MAAM,EAAEvB;MAAG,CAAC;IAClE;IAEAR,SAAS,CAAC,MAAM;MACdgB,aAAa,CAAC;IAChB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}